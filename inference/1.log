+ dirs=("deepseek-base-6.7b")
+ models=("deepseek-ai/deepseek-coder-6.7b-base")
+ temperatures=(0.1)
+ (( i=0 ))
+ (( i<1 ))
+ model=deepseek-ai/deepseek-coder-6.7b-base
+ base_dir=deepseek-base-6.7b
+ echo deepseek-ai/deepseek-coder-6.7b-base
deepseek-ai/deepseek-coder-6.7b-base
+ for temperature in "${temperatures[@]}"
+ dir=deepseek-base-6.7b_temp0.1_input
+ dir=deepseek-base-6.7b_temp0.1_input
+ SIZE=800
+ GPUS=2
+ echo deepseek-base-6.7b_temp0.1_input
deepseek-base-6.7b_temp0.1_input
+ mkdir -p model_generations_raw/deepseek-base-6.7b_temp0.1_input
+ string='Starting iteration 0 with start and end  $(($i*SIZE/GPUS)) $(($ip*SIZE/GPUS))'
+ echo '$string'
$string
+ python3 main.py --model deepseek-ai/deepseek-coder-6.7b-base --use_auth_token --trust_remote_code --tasks input_prediction --batch_size 10 --n_samples 10 --max_length_generation 1024 --precision bf16 --temperature 0.1 --save_generations --save_generations_path model_generations_raw/deepseek-base-6.7b_temp0.1_input/shard_0.json --shuffle --tensor_parallel_size 3
WARNING 10-24 00:25:52 cuda.py:22] You are using a deprecated `pynvml` package. Please install `nvidia-ml-py` instead, and make sure to uninstall `pynvml`. When both of them are installed, `pynvml` will take precedence and cause errors. See https://pypi.org/project/pynvml for more information.
INFO 10-24 00:25:57 llm_engine.py:237] Initializing an LLM engine (v0.6.3.post1) with config: model='deepseek-ai/deepseek-coder-6.7b-base', speculative_config=None, tokenizer='deepseek-ai/deepseek-coder-6.7b-base', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=deepseek-ai/deepseek-coder-6.7b-base, num_scheduler_steps=1, chunked_prefill_enabled=False multi_step_stream_outputs=True, enable_prefix_caching=False, use_async_output_proc=True, use_cached_outputs=False, mm_processor_kwargs=None)
INFO 10-24 00:25:58 model_runner.py:1056] Starting to load model deepseek-ai/deepseek-coder-6.7b-base...
INFO 10-24 00:25:58 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.48it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.43s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.32s/it]

INFO 10-24 00:26:01 model_runner.py:1067] Loading model weights took 12.5708 GB
INFO 10-24 00:26:03 gpu_executor.py:122] # GPU blocks: 1060, # CPU blocks: 512
INFO 10-24 00:26:03 gpu_executor.py:126] Maximum concurrency for 4096 tokens per request: 4.14x
INFO 10-24 00:26:04 model_runner.py:1395] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 10-24 00:26:04 model_runner.py:1399] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 10-24 00:26:20 model_runner.py:1523] Graph capturing finished in 16 secs.
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:01<05:13,  1.58s/it]  1%|          | 2/200 [00:02<03:20,  1.01s/it]  2%|▏         | 3/200 [00:03<03:09,  1.04it/s]  2%|▏         | 4/200 [00:04<03:27,  1.06s/it]  2%|▎         | 5/200 [00:05<03:21,  1.03s/it]  3%|▎         | 6/200 [00:06<03:03,  1.06it/s]  4%|▎         | 7/200 [00:06<02:38,  1.22it/s]  4%|▍         | 8/200 [00:07<02:39,  1.20it/s]  4%|▍         | 9/200 [00:08<02:23,  1.33it/s]  5%|▌         | 10/200 [00:09<02:42,  1.17it/s]  6%|▌         | 11/200 [00:09<02:19,  1.36it/s]  6%|▌         | 12/200 [00:10<02:13,  1.41it/s]  6%|▋         | 13/200 [00:10<02:03,  1.51it/s]  7%|▋         | 14/200 [00:11<01:53,  1.63it/s]  8%|▊         | 15/200 [00:11<01:51,  1.66it/s]  8%|▊         | 16/200 [00:12<01:45,  1.74it/s]  8%|▊         | 17/200 [00:12<01:34,  1.94it/s]  9%|▉         | 18/200 [00:13<01:35,  1.91it/s] 10%|▉         | 19/200 [00:13<01:33,  1.93it/s] 10%|█         | 20/200 [00:14<01:39,  1.82it/s] 10%|█         | 21/200 [00:16<02:53,  1.03it/s] 11%|█         | 22/200 [00:16<02:27,  1.20it/s] 12%|█▏        | 23/200 [00:17<02:12,  1.34it/s] 12%|█▏        | 24/200 [00:17<01:53,  1.55it/s] 12%|█▎        | 25/200 [00:18<01:40,  1.75it/s] 13%|█▎        | 26/200 [00:18<01:41,  1.71it/s] 14%|█▎        | 27/200 [00:19<01:40,  1.72it/s] 14%|█▍        | 28/200 [00:33<12:55,  4.51s/it] 14%|█▍        | 29/200 [00:33<09:40,  3.40s/it] 15%|█▌        | 30/200 [00:34<07:23,  2.61s/it] 16%|█▌        | 31/200 [00:35<05:40,  2.02s/it] 16%|█▌        | 32/200 [00:35<04:27,  1.59s/it] 16%|█▋        | 33/200 [00:49<14:03,  5.05s/it] 17%|█▋        | 34/200 [00:49<10:18,  3.73s/it] 18%|█▊        | 35/200 [00:50<07:31,  2.73s/it] 18%|█▊        | 36/200 [00:51<06:39,  2.44s/it] 18%|█▊        | 37/200 [00:53<05:50,  2.15s/it] 19%|█▉        | 38/200 [00:54<04:36,  1.71s/it] 20%|█▉        | 39/200 [00:54<03:41,  1.37s/it] 20%|██        | 40/200 [00:55<02:58,  1.12s/it] 20%|██        | 41/200 [01:12<15:46,  5.95s/it] 21%|██        | 42/200 [01:13<11:40,  4.43s/it] 22%|██▏       | 43/200 [01:14<09:21,  3.58s/it] 22%|██▏       | 44/200 [01:15<07:08,  2.75s/it] 22%|██▎       | 45/200 [01:16<05:53,  2.28s/it] 23%|██▎       | 46/200 [01:18<05:26,  2.12s/it] 24%|██▎       | 47/200 [01:19<04:25,  1.74s/it] 24%|██▍       | 48/200 [01:20<03:38,  1.44s/it] 24%|██▍       | 49/200 [01:21<03:40,  1.46s/it] 25%|██▌       | 50/200 [01:22<02:56,  1.18s/it] 26%|██▌       | 51/200 [01:23<02:52,  1.16s/it] 26%|██▌       | 52/200 [01:23<02:28,  1.00s/it] 26%|██▋       | 53/200 [01:24<02:08,  1.14it/s] 27%|██▋       | 54/200 [01:24<01:47,  1.36it/s] 28%|██▊       | 55/200 [01:25<01:41,  1.43it/s] 28%|██▊       | 56/200 [01:25<01:29,  1.61it/s] 28%|██▊       | 57/200 [01:27<02:17,  1.04it/s] 29%|██▉       | 58/200 [01:28<01:54,  1.23it/s] 30%|██▉       | 59/200 [01:28<01:53,  1.25it/s] 30%|███       | 60/200 [01:30<02:03,  1.14it/s] 30%|███       | 61/200 [01:30<01:43,  1.34it/s] 31%|███       | 62/200 [01:31<02:02,  1.12it/s] 32%|███▏      | 63/200 [01:32<01:47,  1.27it/s] 32%|███▏      | 64/200 [01:32<01:35,  1.43it/s] 32%|███▎      | 65/200 [01:33<01:30,  1.49it/s] 33%|███▎      | 66/200 [01:34<02:03,  1.09it/s] 34%|███▎      | 67/200 [01:35<01:43,  1.28it/s] 34%|███▍      | 68/200 [01:36<01:54,  1.15it/s] 34%|███▍      | 69/200 [01:36<01:40,  1.31it/s] 35%|███▌      | 70/200 [01:38<01:57,  1.11it/s] 36%|███▌      | 71/200 [01:39<02:11,  1.02s/it] 36%|███▌      | 72/200 [01:40<02:11,  1.03s/it] 36%|███▋      | 73/200 [01:41<02:11,  1.03s/it] 37%|███▋      | 74/200 [01:42<02:04,  1.01it/s] 38%|███▊      | 75/200 [01:42<01:45,  1.19it/s] 38%|███▊      | 76/200 [01:45<02:37,  1.27s/it] 38%|███▊      | 77/200 [01:45<02:19,  1.13s/it] 39%|███▉      | 78/200 [01:46<02:10,  1.07s/it] 40%|███▉      | 79/200 [01:48<02:37,  1.30s/it] 40%|████      | 80/200 [01:49<02:33,  1.28s/it] 40%|████      | 81/200 [01:51<02:48,  1.42s/it] 41%|████      | 82/200 [01:54<03:19,  1.69s/it] 42%|████▏     | 83/200 [01:54<02:44,  1.41s/it] 42%|████▏     | 84/200 [01:55<02:20,  1.21s/it] 42%|████▎     | 85/200 [01:56<01:54,  1.00it/s] 43%|████▎     | 86/200 [01:56<01:31,  1.24it/s] 44%|████▎     | 87/200 [01:57<01:36,  1.17it/s] 44%|████▍     | 88/200 [01:57<01:19,  1.40it/s] 44%|████▍     | 89/200 [01:58<01:17,  1.44it/s] 45%|████▌     | 90/200 [01:59<01:24,  1.31it/s] 46%|████▌     | 91/200 [01:59<01:17,  1.41it/s] 46%|████▌     | 92/200 [02:00<01:15,  1.44it/s] 46%|████▋     | 93/200 [02:01<01:29,  1.20it/s] 47%|████▋     | 94/200 [02:15<08:04,  4.57s/it] 48%|████▊     | 95/200 [02:16<06:23,  3.65s/it] 48%|████▊     | 96/200 [02:17<04:43,  2.72s/it] 48%|████▊     | 97/200 [02:17<03:30,  2.04s/it] 49%|████▉     | 98/200 [02:18<03:03,  1.80s/it] 50%|████▉     | 99/200 [02:19<02:22,  1.42s/it] 50%|█████     | 100/200 [02:20<02:22,  1.42s/it] 50%|█████     | 101/200 [02:22<02:29,  1.51s/it] 51%|█████     | 102/200 [02:22<01:58,  1.21s/it] 52%|█████▏    | 103/200 [02:23<01:33,  1.04it/s] 52%|█████▏    | 104/200 [02:24<01:37,  1.02s/it] 52%|█████▎    | 105/200 [02:37<07:19,  4.63s/it] 53%|█████▎    | 106/200 [02:38<05:21,  3.42s/it] 54%|█████▎    | 107/200 [02:38<03:55,  2.53s/it] 54%|█████▍    | 108/200 [02:39<02:55,  1.91s/it] 55%|█████▍    | 109/200 [02:39<02:19,  1.53s/it] 55%|█████▌    | 110/200 [02:40<01:53,  1.27s/it] 56%|█████▌    | 111/200 [02:53<07:17,  4.92s/it] 56%|█████▌    | 112/200 [02:54<05:23,  3.67s/it] 56%|█████▋    | 113/200 [03:07<09:31,  6.56s/it] 57%|█████▋    | 114/200 [03:08<06:59,  4.88s/it] 57%|█████▊    | 115/200 [03:09<05:05,  3.59s/it] 58%|█████▊    | 116/200 [03:10<03:57,  2.83s/it] 58%|█████▊    | 117/200 [03:11<03:02,  2.20s/it] 59%|█████▉    | 118/200 [03:11<02:18,  1.68s/it] 60%|█████▉    | 119/200 [03:12<02:04,  1.54s/it] 60%|██████    | 120/200 [03:13<01:34,  1.18s/it] 60%|██████    | 121/200 [03:13<01:17,  1.02it/s] 61%|██████    | 122/200 [03:14<01:10,  1.10it/s] 62%|██████▏   | 123/200 [03:14<01:00,  1.28it/s] 62%|██████▏   | 124/200 [03:16<01:18,  1.04s/it] 62%|██████▎   | 125/200 [03:17<01:09,  1.07it/s] 63%|██████▎   | 126/200 [03:17<00:57,  1.28it/s] 64%|██████▎   | 127/200 [03:18<01:05,  1.12it/s] 64%|██████▍   | 128/200 [03:19<00:57,  1.26it/s] 64%|██████▍   | 129/200 [03:20<00:53,  1.32it/s] 65%|██████▌   | 130/200 [03:20<00:44,  1.58it/s] 66%|██████▌   | 131/200 [03:21<00:47,  1.46it/s] 66%|██████▌   | 132/200 [03:22<00:53,  1.26it/s] 66%|██████▋   | 133/200 [03:23<00:54,  1.23it/s] 67%|██████▋   | 134/200 [03:24<01:01,  1.08it/s] 68%|██████▊   | 135/200 [03:24<00:53,  1.21it/s] 68%|██████▊   | 136/200 [03:25<00:51,  1.25it/s] 68%|██████▊   | 137/200 [03:26<00:45,  1.37it/s] 69%|██████▉   | 138/200 [03:27<00:46,  1.33it/s] 70%|██████▉   | 139/200 [03:28<00:57,  1.07it/s] 70%|███████   | 140/200 [03:28<00:49,  1.21it/s] 70%|███████   | 141/200 [03:29<00:45,  1.31it/s] 71%|███████   | 142/200 [03:30<00:46,  1.25it/s] 72%|███████▏  | 143/200 [03:30<00:39,  1.44it/s] 72%|███████▏  | 144/200 [03:32<00:56,  1.01s/it] 72%|███████▎  | 145/200 [03:33<00:50,  1.09it/s] 73%|███████▎  | 146/200 [03:34<00:52,  1.03it/s] 74%|███████▎  | 147/200 [03:35<00:57,  1.09s/it] 74%|███████▍  | 148/200 [03:50<04:28,  5.17s/it] 74%|███████▍  | 149/200 [03:50<03:11,  3.75s/it] 75%|███████▌  | 150/200 [03:51<02:24,  2.88s/it] 76%|███████▌  | 151/200 [04:08<05:40,  6.94s/it] 76%|███████▌  | 152/200 [04:08<04:03,  5.07s/it] 76%|███████▋  | 153/200 [04:09<03:00,  3.83s/it] 77%|███████▋  | 154/200 [04:10<02:09,  2.83s/it] 78%|███████▊  | 155/200 [04:10<01:36,  2.15s/it] 78%|███████▊  | 156/200 [04:11<01:20,  1.82s/it] 78%|███████▊  | 157/200 [04:13<01:08,  1.59s/it] 79%|███████▉  | 158/200 [04:13<00:53,  1.26s/it] 80%|███████▉  | 159/200 [04:13<00:41,  1.01s/it] 80%|████████  | 160/200 [04:14<00:36,  1.10it/s] 80%|████████  | 161/200 [04:15<00:32,  1.19it/s] 81%|████████  | 162/200 [04:16<00:31,  1.21it/s] 82%|████████▏ | 163/200 [04:16<00:25,  1.45it/s] 82%|████████▏ | 164/200 [04:16<00:23,  1.55it/s] 82%|████████▎ | 165/200 [04:17<00:22,  1.58it/s] 83%|████████▎ | 166/200 [04:18<00:19,  1.73it/s] 84%|████████▎ | 167/200 [04:18<00:19,  1.71it/s] 84%|████████▍ | 168/200 [04:19<00:18,  1.73it/s] 84%|████████▍ | 169/200 [04:20<00:22,  1.40it/s] 85%|████████▌ | 170/200 [04:21<00:28,  1.06it/s] 86%|████████▌ | 171/200 [04:23<00:33,  1.14s/it] 86%|████████▌ | 172/200 [04:23<00:25,  1.09it/s] 86%|████████▋ | 173/200 [04:41<02:41,  5.99s/it] 87%|████████▋ | 174/200 [04:42<01:53,  4.37s/it] 88%|████████▊ | 175/200 [04:42<01:20,  3.22s/it] 88%|████████▊ | 176/200 [04:43<01:00,  2.54s/it] 88%|████████▊ | 177/200 [04:44<00:45,  1.96s/it] 89%|████████▉ | 178/200 [04:44<00:34,  1.57s/it] 90%|████████▉ | 179/200 [04:45<00:29,  1.43s/it] 90%|█████████ | 180/200 [04:46<00:23,  1.17s/it] 90%|█████████ | 181/200 [04:47<00:18,  1.03it/s] 91%|█████████ | 182/200 [04:48<00:18,  1.02s/it] 92%|█████████▏| 183/200 [04:48<00:15,  1.13it/s] 92%|█████████▏| 184/200 [04:49<00:11,  1.34it/s] 92%|█████████▎| 185/200 [04:49<00:10,  1.42it/s] 93%|█████████▎| 186/200 [04:50<00:10,  1.37it/s] 94%|█████████▎| 187/200 [04:51<00:10,  1.22it/s] 94%|█████████▍| 188/200 [04:52<00:09,  1.31it/s] 94%|█████████▍| 189/200 [04:52<00:07,  1.42it/s] 95%|█████████▌| 190/200 [04:54<00:09,  1.01it/s] 96%|█████████▌| 191/200 [04:54<00:07,  1.17it/s] 96%|█████████▌| 192/200 [04:55<00:06,  1.24it/s] 96%|█████████▋| 193/200 [04:56<00:05,  1.23it/s] 97%|█████████▋| 194/200 [04:57<00:05,  1.01it/s] 98%|█████████▊| 195/200 [04:58<00:04,  1.08it/s] 98%|█████████▊| 196/200 [05:12<00:18,  4.67s/it] 98%|█████████▊| 197/200 [05:12<00:10,  3.40s/it] 99%|█████████▉| 198/200 [05:13<00:05,  2.55s/it]100%|█████████▉| 199/200 [05:13<00:01,  1.99s/it]100%|██████████| 200/200 [05:14<00:00,  1.69s/it]100%|██████████| 200/200 [05:14<00:00,  1.57s/it]
generations were saved at model_generations_raw/deepseek-base-6.7b_temp0.1_input/shard_0.json
generations were saved at model_generations_raw/deepseek-base-6.7b_temp0.1_input/shard_0_raw.json
[rank0]:[W1024 00:31:36.129765303 ProcessGroupNCCL.cpp:1168] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
+ (( i++ ))
+ (( i<1 ))
